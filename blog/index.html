<!DOCTYPE html>
<html lang="zh-TW" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>莫比空間</title>

<style>
:root {
  --bg-body:#000;
  --bg-container:#111;
  --bg-card:#222;
  --bg-input:#333;
  --text-main:#fff;
  --text-sub:#aaa;
  --border-color:#333;
  --accent-color:#06c755;
  --nav-bg:#111;
  --icon-size:22px;
}

/* Light mode */
html[data-theme="light"] {
  --bg-body:#f7f7f7;
  --bg-container:#fff;
  --bg-card:#f2f2f2;
  --bg-input:#e5e5e5;
  --text-main:#000;
  --text-sub:#555;
  --border-color:#ddd;
  --nav-bg:#fff;
}

body { margin:0; background:var(--bg-body); color:var(--text-main); font-family:-apple-system; }

svg.icon {
  width: var(--icon-size);
  height: var(--icon-size);
  stroke: currentColor;
  fill: none;
  stroke-width:2;
}

/* 底部導覽 */
.bottom-nav {
  position:fixed; bottom:0; left:0; right:0;
  max-width:480px; margin:auto;
  height:60px;
  background:var(--nav-bg);
  border-top:1px solid var(--border-color);
  display:flex; justify-content:space-around; align-items:center;
}
.nav-item { font-size:10px; color:var(--text-sub); text-decoration:none; text-align:center; }
.nav-item.active { color:var(--text-main); }

/* 設定彈窗 */
.settings-modal {
  position:fixed; inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  z-index:5000;
}
.settings-modal.show { display:flex; align-items:flex-end; }

.settings-sheet {
  width:100%;
  max-width:480px;
  margin:auto;
  background:var(--bg-card);
  border-radius:20px 20px 0 0;
  height:50vh;
  display:flex;
  flex-direction:column;
  transition:.3s;
}

.settings-sheet.full { height:95vh; }

.settings-header {
  padding:12px;
  display:flex;
  justify-content:space-between;
  border-bottom:1px solid var(--border-color);
}

.settings-body { flex:1; overflow:hidden; }

.settings-footer {
  padding:12px;
  display:flex;
  gap:10px;
}

.btn {
  flex:1;
  padding:12px;
  border-radius:10px;
  border:none;
  background:var(--accent-color);
  color:white;
}

/* 修正 keep 彈窗 */
#keepModal .half-modal-content { display:flex; flex-direction:column; }
</style>
</head>

<body>

<!-- 原結構保留 -->
<div id="app-container">
  <main id="main-view" style="padding-bottom:80px;"></main>

  <nav class="bottom-nav">
    <a href="/" class="nav-item active" data-link>
      <svg class="icon"><path d="M3 12L12 3l9 9v8H3z"/></svg>
      首頁
    </a>
    <a href="/explore" class="nav-item" data-link>
      <svg class="icon"><circle cx="12" cy="12" r="9"/></svg>
      探索
    </a>
    <a href="/shorts" class="nav-item" data-link>
      <svg class="icon"><polygon points="9,7 17,12 9,17"/></svg>
      Shorts
    </a>
    <a href="#" class="nav-item" onclick="openSettings()">
      <svg class="icon"><circle cx="12" cy="12" r="3"/><path d="M12 2v4M12 18v4M2 12h4M18 12h4"/></svg>
      設定
    </a>
  </nav>
</div>

<!-- 設定彈窗 -->
<div id="settingsModal" class="settings-modal" onclick="closeSettings()">
  <div class="settings-sheet" onclick="event.stopPropagation()">
    <div class="settings-header">
      <strong>⚙️ 設定中心</strong>
      <button onclick="toggleFull()">展開</button>
    </div>

    <div class="settings-body">
      <iframe src="/settings" style="border:none;width:100%;height:100%;"></iframe>
    </div>

    <div class="settings-footer">
      <button class="btn" onclick="closeSettings()">關閉</button>
    </div>
  </div>
</div>

<script>
/* 彈窗控制 */
function openSettings(){ settingsModal.classList.add('show'); }
function closeSettings(){ settingsModal.classList.remove('show'); }
function toggleFull(){
  document.querySelector('.settings-sheet').classList.toggle('full');
}

/* 同步設定 */
(function(){
  const theme = localStorage.getItem("theme");
  const font = localStorage.getItem("fontSize");
  if(theme) document.documentElement.setAttribute("data-theme", theme);
  if(font) document.documentElement.style.fontSize = font+"px";
})();
</script>

</body>
</html>