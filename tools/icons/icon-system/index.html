<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Mobispace Icon Builder</title>

  <!-- ============================= -->
  <!-- åŸºæœ¬ RWD è¨­å®šï¼Œç¢ºä¿æ‰‹æ©Ÿå¯ç”¨ -->
  <!-- ============================= -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    /* ============================= */
    /* åŸºæœ¬ä»‹é¢æ¨£å¼ï¼ˆä¹¾æ·¨ã€å¯è®€ï¼‰     */
    /* ============================= */
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      padding: 20px;
      background: #0f172a;
      color: #e2e8f0;
    }

    h1 { font-size: 22px; }

    textarea {
      width: 100%;
      min-height: 140px;
      background: #020617;
      color: #e2e8f0;
      border: 1px solid #334155;
      padding: 10px;
      border-radius: 6px;
      font-family: ui-monospace, monospace;
    }

    button {
      margin-top: 12px;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      background: #38bdf8;
      color: #020617;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover {
      opacity: 0.9;
    }

    pre {
      background: #020617;
      border: 1px solid #334155;
      padding: 12px;
      border-radius: 6px;
      min-height: 160px;
      white-space: pre-wrap;
      font-size: 13px;
    }

    .hint {
      font-size: 13px;
      color: #94a3b8;
      margin-bottom: 6px;
    }
  </style>
</head>

<body>

<h1>ğŸ›  Mobispace Icon Builder</h1>

<div class="hint">
  æ¯è¡Œè¼¸å…¥ä¸€å€‹ icon åç¨±ï¼ˆå°æ‡‰ circumicons.com/icons/xxx.svgï¼‰
</div>

<textarea id="list">
youtube
github
home
user
settings
</textarea>

<button onclick="buildIcons()">é–‹å§‹æŠ“å–ä¸¦ç”Ÿæˆæª”æ¡ˆ</button>

<h2>åŸ·è¡Œç´€éŒ„</h2>
<pre id="log"></pre>

<script>
/* ============================================================
   æ ¸å¿ƒè¨­å®šå€
   ------------------------------------------------------------
   BASE_URLï¼šicon ä¾†æºç¶²å€
   å¯ä»¥æ›¿æ›æˆä»»ä½•æä¾› SVG çš„ API
   ============================================================ */
const BASE_URL = "https://raw.githubusercontent.com/Klarr-Agency/Circum-Icons/main/svg/";

/* ============================================================
   log è¼¸å‡ºå·¥å…·
   ============================================================ */
const logBox = document.getElementById("log");
function log(text) {
  logBox.textContent += text + "\n";
}

/* ============================================================
   ä¸»æµç¨‹ï¼šæŠ“å– â†’ è½‰æ› â†’ ç”¢å‡ºæª”æ¡ˆ
   ============================================================ */
async function buildIcons() {
  logBox.textContent = "";

  const raw = document.getElementById("list").value;

  const names = raw
    .split("\n")             // æ¯è¡Œä¸€å€‹
    .map(s => s.trim())      // å»é™¤ç©ºç™½
    .filter(Boolean);        // ç§»é™¤ç©ºè¡Œ

  if (!names.length) {
    log("âŒ æ²’æœ‰è¼¸å…¥ä»»ä½• icon åç¨±");
    return;
  }

  log(`é–‹å§‹æŠ“å– ${names.length} å€‹ icons...\n`);

  const symbols = [];
  const success = [];
  const failed = [];

  for (const name of names) {
    const url = BASE_URL + name + ".svg";

    try {
      log(`æŠ“å–ï¼š${url}`);

      const res = await fetch(url);
      if (!res.ok) throw new Error("HTTP " + res.status);

      let svg = await res.text();

      /* ============================================================
         å°‡ <svg> çµæ§‹è½‰æ›ç‚º <symbol>
         é€™æ¨£æ‰èƒ½ç”¨æ–¼ sprite æŠ€è¡“
         ============================================================ */
      svg = svg
        .replace(/<svg[^>]*>/, `<symbol id="icon-${name}" viewBox="0 0 24 24">`)
        .replace("</svg>", "</symbol>");

      symbols.push(svg);
      success.push(name);

      log(`âœ” æˆåŠŸï¼š${name}`);
    } catch (err) {
      failed.push(name);
      log(`âœ– å¤±æ•—ï¼š${name}`);
    }
  }

  /* ============================================================
     çµ„è£æœ€çµ‚ sprite.svg
     ============================================================ */
  const sprite = `
<svg xmlns="http://www.w3.org/2000/svg" style="display:none">
${symbols.join("\n")}
</svg>
`.trim();

  /* ============================================================
     icons.json çµæ§‹åŒ–æ¸…å–®
     ============================================================ */
  const json = JSON.stringify(success, null, 2);

  /* ============================================================
     è‡ªå‹•ä¸‹è¼‰æª”æ¡ˆ
     ============================================================ */
  download("sprite.svg", sprite);
  download("icons.json", json);

  log("\n============================");
  log(`æˆåŠŸï¼š${success.length}`);
  log(`å¤±æ•—ï¼š${failed.length}`);
  log("å·²ä¸‹è¼‰ï¼šsprite.svg + icons.json");
  log("============================");
}

/* ============================================================
   å»ºç«‹ç€è¦½å™¨ä¸‹è¼‰
   ============================================================ */
function download(filename, content) {
  const blob = new Blob([content], { type: "text/plain" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = filename;
  a.click();

  URL.revokeObjectURL(url);
}
</script>

</body>
</html>
